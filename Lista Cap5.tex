\documentclass[12pt,a4paper]{article}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{makeidx,graphics}
\usepackage[dvips]{graphicx}
\usepackage[portuguese]{babel}
\usepackage[utf8]{inputenc}
\usepackage{ae}
\usepackage{indentfirst}
\usepackage{amsbsy}
\usepackage{fancyhdr}
\usepackage{pstricks}
\usepackage[all]{xy}
\usepackage{wrapfig}
\usepackage[pdfstartview=FitH,backref,colorlinks,bookmarksnumbered,bookmarksopen,linktocpage,urlcolor=blue,linkcolor=cyan]{hyperref}
\usepackage{bussproofs}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{amsfonts}
\usepackage{wasysym}
\usepackage{url}
\usepackage{float} 
\usepackage{subcaption}
\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\usepgfplotslibrary{fillbetween}
\usepackage[shortlabels]{enumitem}
\usepackage{esint}
\usepackage{multicol}
\usepackage{todonotes}

\newtheorem{definition}{Definição}
\newtheorem{lema}{Lema}
\newtheorem{teorema}{Teorema}
\newtheorem{corolario}{Corolário}
\newtheorem*{obs}{Observação}

\setlength{\topmargin}{-1.0in}
\setlength{\oddsidemargin}{0in}
\setlength{\evensidemargin}{0in}
\setlength{\textheight}{10.5in}
\setlength{\textwidth}{6.5in}
\setlength{\baselineskip}{12mm}

\newcommand{\dx}{\ \mathrm{d} x }
\newcommand{\dy}{\ \mathrm{d} y }
\newcommand{\dz}{\ \mathrm{d} z }
\newcommand{\du}{\ \mathrm{d} u }
\newcommand{\dv}{\ \mathrm{d} v }
\newcommand{\dr}{\ \mathrm{d} r }
\newcommand{\dt}{\ \mathrm{d} t }
\newcommand{\dteta}{\ \mathrm{d} \theta }
\newcommand{\dro}{\ \mathrm{d} \rho }
\newcommand{\dfi}{\ \mathrm{d} \phi }
\newcommand{\ds}{\ \mathrm{d} s }
\newcommand{\dS}{\ \mathrm{d} S }
\newcommand{\dq}{\ \mathrm{d} q }
\newcommand{\dif}{\mathrm{d}}
\newcommand{\res}{\mathrm{res}}

\DeclareMathOperator{\rot}{rot}
\DeclareMathOperator{\diverg}{div}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\Sym}{Sym}

\newcommand{\C}{\mathbb{C}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\renewcommand{\P}{\mathbb{P}}
\newcommand{\F}{\mathcal{F}}
\renewcommand{\Re}{\mathrm{Re}}
\renewcommand{\Im}{\mathrm{Im}}

\graphicspath{{img/}}

\renewcommand{\sectionmark}[1]{ \markright{ \thesection.\ #1}}

\title{\textbf{Análise 2}\\ Exercícios Cap. 5}
\author{Caio Tomás de Paula}
\date{07/03/2022}
\begin{document}

\maketitle

\paragraph{Exercício 1.}
    %
    \begin{proof}
        Temos que
        %
        \begin{equation*}
            f'(x) = a + 2x\sin(1/x) - \cos(1/x), \forall x\in\R - \{0\}.
        \end{equation*}
        %
        Ademais,
        %
        \begin{align*}
            \lim_{h\to 0} \frac{f(h) - f(0)}{h} 
            = \lim_{h\to 0} \frac{ah + h^2\sin(1/h)}{h}
            = \lim_{h\to 0} a + h\sin(1/h)
            = a
        \end{align*}
        %
        pelo Teorema do Sanduíche, ou seja, $f'(0) = a$. Portanto, $f$ é
        diferenciável em $0$. Note, ainda, que
        %
        \begin{equation*}
            \lim_{x\to 0} f'(x) = \lim_{x\to 0} a + 2x\sin(1/x) - \cos(1/x)
        \end{equation*}
        %
        não existe, ou seja, $f'$ não é contínua ou, equivalentemente, $f\notin C^1$.
        Por último, observe que $f'(0) = a$ é injetiva (função constante) mas
        $f$ não é biunívoca em vizinhança alguma da origem devido à parcela com o fato de
        $\sin(1/x)$.
    \end{proof}
    %
\paragraph{Exercício 2.}
    %
    \begin{proof}
        Da convexidade de $U$, temos que $[a, a+h]\subset U$. Assim,
        podemos aplicar a desigualdade do valor médio e usar a limitação
        da derivada para obter
        %
        \begin{align*}
            |f(a+h) - f(a)| &\leq |h|\cdot\sup_{0<t<1} |f'(a+th)| \\
                            &\leq |h|M.
        \end{align*}
        %
        Daí, dado $\varepsilon >0$ podemos tomar $h$ tal que $|h| < \varepsilon/M$
        e, assim,
        %
        \begin{equation*}
            |f(a+h) - f(a)| \leq |h|M < \varepsilon,
        \end{equation*}
        %
        para todo $a\in U$. Logo, $f$ é uniformemente contínua em $U$. Ademais,
        se $f'$ existe e é uniformemente contínua em $U$, então dado 
        $\varepsilon > 0$ existe $\delta > 0$ tal que
        %
        \begin{equation*}
            |f'(a+h) - f'(a)| < \varepsilon
        \end{equation*}
        %
        para todo $|h| < \delta$ e $a\in U$, ou seja, $f$ é uniformemente diferenciável
        em $U$. Em particular, se $f''$ existe e é limitada por $M$ em $U$, então
        segue da Desigualdade do Valor Médio que
        %
        \begin{equation*}
            |f'(a+h) - f'(a)| \leq M|h|
        \end{equation*}
        %
        e, dado $\varepsilon > 0$, basta tomar
        $\delta = \varepsilon/M$ para que tenhamos,
        para todo $|h| < \delta$,
        %
        \begin{equation*}
            |f'(a+h) - f'(a)| < \varepsilon,
        \end{equation*}
        %
        ou seja, $f$ é uniformemente diferenciável.
    \end{proof}
    %
\paragraph{Exercício 3.}
    %
    \begin{proof}
        Segue da Proposição 5.1, da continuidade de $f'$ e da compacidade de $K$:
        pela proposição, temos que para cada $x\in K$ existe $c_x$ tal que
        %
        \begin{equation*}
            |f(x+h) - f(x)| \geq c_x|h|,
        \end{equation*}
        %
        para todo $|h|<\delta$. Daí, segue que
        %
        \begin{equation*}
            |f'(x)| \geq c_x \geq c,
        \end{equation*}
        %
        sendo
        %
        \begin{equation*}
            c = \min_{x\in K} c_x,
        \end{equation*}
        %
        que existe porque $f'$ é contínua e $K$ é compacto. Logo, para todo $x\in K$
        e $|h| < \delta$, vale
        %
        \begin{equation*}
            |f(x+h) - f(x)| \geq c|h|,
        \end{equation*}
        %
        como queríamos mostrar.
    \end{proof}
    %
\paragraph{Exercício 4.}
    %
    \begin{enumerate}[a)]
        \item Temos
        %
        \begin{equation*}
            d_U(a,b) = \inf\left\{ \sum_{i=1}^{k-1} |x_{i+1} - x_i| \right\},
        \end{equation*}
        %
        sendo $x_1, \dots, x_k\in\R^m$ vértices de uma poligonal que liga
        $a$ e $b$. Como os elementos do conjunto sobre o qual tomamos o ínfimo
        são todos maiores ou iguais a zero, segue que $d_U(a,b) \geq 0$ para
        todo par $(a,b)\in\R^m\times\R^m$.
        
        Ademais, se $a=b$ é evidente que o ínfimo é $0$, pois esse é o menor
        valor no conjunto. Reciprocamente, se
        $d_U(a,b) = 0$, então existe uma poligonal de comprimento nulo ligando
        $a$ e $b$, ou seja, $a=b$.
        
        Por fim, $d_U$ obedece a desigualdade triangular pois a norma $|\cdot|$
        em $\R^2$ o faz.
        
        No caso em que $U$ é convexo, sempre existe um segmento de reta inteiramente
        contido em $U$ que liga $a$ e $b$; pela desigualdade triangular,
        o comprimento desse segmento, $|a-b|$, é maior ou igual ao comprimento de
        qualquer poligonal ligando $a$ e $b$. Portanto, nesse caso temos
        $d_U(a,b) = |a-b|$.
        
        Por fim, para $U$ um aberto conexo qualquer, temos do exposto acima que
        %
        \begin{equation*}
            |a-b| \leq d_U(a,b),
        \end{equation*}
        %
        para quaisquer $a,b\in\R^m$. Agora, note que dada uma bola $B$ na métrica usual
        centrada num ponto qualquer $a\in U$, existe uma bola $B'$ na métrica $d_U$ de centro 
        $a$ e raio menor que $B$ e, além disso, existe uma terceira bola $B''$ de centro
        $a$ na métrica usual contida em $B'$. Logo, $d_U$ é equivalente à métrica usual
        para $U$ aberto conexo qualquer.
        
        \item Pela Desigualdade do Valor Médio, temos que se existe $M > 0$
        tal que $|f'(x)| \leq M$
        para todo $x\in U$ então
        %
        \begin{equation*}
            |f(x) - f(y)| \leq M|x-y| \leq M d_U(x,y),
        \end{equation*}
        %
        onde a última desigualdade segue do item anterior.
        
        \item Pela Desigualdade do Valor Médio e do fato que a derivada de $f$
        é limitada por $M$ em $V$, temos
        %
        \begin{equation*}
            d_V(f(x), f(y)) \leq |x-y| \sup_{0<t<1} \{ d_V(f'(y + t(x-y)), 0) \}
                            \leq M |x-y|,
        \end{equation*}
        %
        para quaisquer $x,y\in U$.
        
        \item Supondo $m>1$, temos $A$ aberto conexo.
        Ora, em $U$ temos $|x-y| = d_U(x,y)$. Como $d_A(x,y)$ é,
        por definição, o ínfimo dos comprimentos das poligonais
        ligando $x$ a $y$, temos dois casos:
        %
        \begin{enumerate}
            \item o segmento de reta ligando $x$ a $y$ tem
            um ponto que pertence a $D$;
            \item o segmento de reta ligando $x$ a $y$ não tem
            nenhum ponto que pertence a $D$;
        \end{enumerate}
        %
        No segundo caso, $|x-y| = d_A(x,y)$. No segundo caso, 
        retirar uma quantidade enumerável de pontos de um
        segmento de reta não muda o seu comprimento e,
        portanto, o ínfimo se mantém o mesmo e temos também
        $|x-y| = d_A(x,y)$ nesse caso.
        
        Portanto, $f$ pode ser estendida a uma aplicação 
        uniformemente contínua $F:U\to\R^n$. Supondo ainda 
        que $|f''(x)| \leq N$, temos que $F$ é de classe $C^1$
        pela desigualdade do valor médio.
    \end{enumerate}
    %
\paragraph{Exercício 5.}
    %
    \begin{proof}
        Primeiro, supondo $E = \R^m$ com a norma do máximo e $F = \R^n$ com
        a norma do máximo, temos que
        %
        \begin{align*}
            |T| \geq |T\cdot e_j| = \max_i |t_{ij}|, \forall j = 1, \dots, m.
        \end{align*}
        %
        Logo,
        %
        \begin{align*}
            |T| \geq \max_{i,j} |t_{ij}|, \forall j = 1, \dots, m,
        \end{align*}
        %
        com $i = 1, \dots, n$. Por outro lado, considerando o vetor $v = (1,\dots,1)$
        em $\R^m$ (que tem norma $1$), temos que
        %
        \begin{align*}
            |T \cdot v|
            &= \left|\begin{bmatrix}
                \displaystyle{\sum_{j=1}^m t_{1j}} \\
                \vdots \\
                \displaystyle{\sum_{j=1}^m t_{nj}} \\
            \end{bmatrix}\right| \\
            &= \max_{1\leq i\leq n} \left| \displaystyle{\sum_{j=1}^m t_{ij}} \right| \\
            &\leq \max_i \displaystyle{\sum_{j=1}^m |t_{ij}|} \\
            &\leq \max_i \{m\cdot\max_j |t_{ij}|\} \\
            &= m\max_{i,j} |t_{ij}|.
        \end{align*}
        %
        Logo, como para qualquer outro vetor $u$ de norma $1$ em $\R^m$ teremos
        $|T\cdot u| \leq |T\cdot v|$, segue que
        %
        \begin{equation*}
            |T| \leq m \max_{i,j}|t_{ij}|.
        \end{equation*}
        %
        Agora, se tomarmos $E = \R^m$ com a norma da soma e $F = \R^n$ com
        a norma do máximo, teremos como antes que
        %
        \begin{align*}
            |T| \geq |T\cdot e_j| = \max_i |t_{ij}|, \forall j = 1, \dots, m.
        \end{align*}
        %
        mas agora, tomando $v = (1/m, \dots, 1/m)$, que é unitário em $\R^m$ 
        com a norma da soma, teremos
        %
        \begin{align*}
            |T \cdot v|
            &= \left|\begin{bmatrix}
                \displaystyle{\frac{1}{m}\sum_{j=1}^m t_{1j}} \\
                \vdots \\
                \displaystyle{\frac{1}{m}\sum_{j=1}^m t_{nj}} \\
            \end{bmatrix}\right| \\
            &\leq \frac{1}{m}\cdot\max_i \displaystyle{\sum_{j=1}^m |t_{ij}|} \\
            &\leq \frac{1}{m}\cdot\max_i \{m\cdot\max_j |t_{ij}|\} \\
            &= \max_{i,j} |t_{ij}|.
        \end{align*}
        %
        Logo, argumentando como acima, segue que
        %
        \begin{equation*}
            |T| \leq \max_{i,j} |t_{ij}|
        \end{equation*}
        %
        e, portanto,
        %
        \begin{equation*}
            T = \max_{i,j} |t_{ij}|.
        \end{equation*}
        %
    \end{proof}
    %
\paragraph{Exercício 6.}
    %
    \begin{proof}
        Note que em qualquer ponto $(x_0, t_0)\in\R^2$ com $t_0\neq 0$ teremos
        $F$ contínua, pois
        %
        \begin{align*}
            \lim_{(x,t)\to (x_0,t_0)} F(x,t)
            = \lim_{(x,t)\to (x_0,t_0)} \frac{f(x+t) - f(x)}{t}
            = \frac{f(x_0+t_0) - f(x_0)}{t_0}
            = F(x_0, t_0).
        \end{align*}
        %
        Em particular, $F$ é contínua em $x$. Daí, temos
        %
        \begin{align*}
            \lim_{(x,t) \to (x, 0)} F(x,t)
            = \lim_{t\to 0} \frac{f(x+t) - f(x)}{t}
            = f'(x)
            = F(x,0),
        \end{align*}
        %
        de modo que $F$ é contínua em $\R^2$.
    \end{proof}
    %
\paragraph{Exercício 7.}
    %
    A princípio, o maior $U$ que podemos tomar é
    %
    \begin{equation*}
        U = \mathcal{Q}_1 \cup \mathcal{Q}_3,
    \end{equation*}
    %
    ou seja, a união do primeiro e terceiro quadrantes (sem incluir os eixos). Considere a norma de matrizes $|\cdot|_1$ 
    dada pelo máximo da soma dos
    módulos dos elementos de cada linha. Note que
    %
    \begin{equation*}
        f'(x,y) = 
        \begin{bmatrix}
            y/x & 1/2 \\
            x/y & 1/2
        \end{bmatrix},
    \end{equation*}
    %
    donde temos
    %
    \begin{equation*}
        |f'(x,y)|_1 = \max(|y/x| + 1/2; |x/y| + 1/2).
    \end{equation*}
    %
    Supondo que $|f'(x,y)|_1 \leq 1$ e usando que $xy>0$, temos que
    %
    \begin{align*}
        \begin{cases}
            y/x &\leq 1/2 \\
            x/y &\leq 1/2
        \end{cases} \iff
        2x \leq y \leq x/2.
    \end{align*}
    %
    Portanto, considerando essa norma, temos que
    %
    \begin{equation*}
        \| f(q) - f(p) \| \leq |q-p|_1\sup_{0<t<1}|f'(q + t(p-q))|
                          \leq |q-p|_1,
    \end{equation*}
    %
    pela desigualdade do valor médio, para todos $q,p \in U$, sendo
    %
    \begin{equation*}
        U = \{ (x,y)\in\R^2 : 2x \leq y \leq x/2 \}.
    \end{equation*}
    %
    Note que, como esse conjunto é convexo, temos $q + t(p-q)\in U$
    para todo $0<t<1$ sempre que $q,p\in U$.
    %
\paragraph{Exercício 8.}
    %
    \begin{proof}
        Pelo Corolário 2, temos que se $f\in C^1$ então
        %
        \begin{align*}
            |f(x+h) - f(x+k) - f'(x)\cdot (h-k)| \leq |h-k|\sup_{0<t<1} |f'(x+h + t(h-k)) - f'(x)|,
        \end{align*}
        %
        donde segue o limite quando $(h,k)\to (0,0)$.
        
        Reciprocamente, suponha que existe $A(x)\in\mathcal{L}(\R^n, \R^m)$ tal que
        %
        \begin{equation*}
            \lim_{(h,k)\to (0,0)} \frac{f(x+h) - f(x+k) - A(x)\cdot (h-k)}{|h-k|} = 0
        \end{equation*}
        %
        para cada $x\in U$. Ora, então a expressão no interior do limite nada mais é que
        o erro na aproximação de $f$ pela derivada, ou seja, $f\in C^1$.
    \end{proof}
    %
\paragraph{Exercício 9.}
    %
    \begin{proof}
        Para $v\in\R^m$ com norma pequena, temos pela D.V.M. que
        %
        \begin{equation*}
            |f(v)| \leq |v|\cdot|f'(\theta v)|, 
        \end{equation*}
        %
        para um certo $0 < \theta < 1$. Daí,
        %
        \begin{equation*}
            \frac{|f(v)|}{|v|^2} \leq \frac{|v|\cdot |f'(\theta v)|}{|v|^2} = \frac{|f'(\theta v)|}{|v|}.
        \end{equation*}
        %
        Logo, basta mostrarmos que
        %
        \begin{equation*}
            \lim_{v\to 0} \frac{|f'(\theta v)|}{|v|} = 0.
        \end{equation*}
        %
        Para tanto, basta lembrar que $f'(\theta)h$ é diferenciável na origem e $f''(\theta v)h\equiv 0$
        por hipótese. Logo, o erro na aproximação de $f''$ é
        %
        \begin{equation*}
            r(h) = f'(\theta v)h
        \end{equation*}
        %
        com
        %
        \begin{equation*}
            \lim_{h\to 0} \frac{|f'(\theta v)h|}{|h|} = 0,
        \end{equation*}
        %
        donde segue o resultado.
    \end{proof}
    %
\paragraph{Exercício 10.}
    %
    \begin{proof}
        Note que, definindo
        %
        \begin{equation*}
            r(h) = f(a+h) - f(a) - f'(a)\cdot h - \frac{1}{2}f''(a)(h,h),
        \end{equation*}
        %
        temos que
        %
        \begin{equation*}
            r(0) = 0 = r'(0)
        \end{equation*}
        %
        e também $r''(0)$. Logo, pelo Exercício 9, segue que
        %
        \begin{equation*}
            \lim_{h\to 0} \frac{r(h)}{|h|^2} = 0.
        \end{equation*}
        %
    \end{proof}
    %
\paragraph{Exercício 11.}
    %
    \begin{proof}
        % Dado $\varepsilon > 0$, defina
        % %
        % \begin{equation*}
        %     X = \{ t\in [0,1] : |f(t) - f(0)| \leq g(t) - g(0) + 
        %                                       \varepsilon t + \varepsilon \}.
        % \end{equation*}
        % %
        % Note que $0\in X$, logo $X\neq\varnothing$. Ademais, dada uma sequência
        % $(a_n)_{n\in\N}$ de pontos de $X$ que converge para $a$, temos que
        % %
        % \begin{equation*}
        %     |f(a_n) - f(0)| \leq g(a_n) - g(0) + \varepsilon a_n + \varepsilon, 
        %     \forall n\in\N.
        % \end{equation*}
        % %
        % Tomando o limite e usando a diferenciabilidade de $f$ e de $g$, temos
        % %
        % \begin{equation*}
        %     |f(a) - f(0)| \leq g(a) - g(0) + \varepsilon a + \varepsilon,
        % \end{equation*}
        % %
        % ou seja, $a\in X$ e, portanto, $X$ é fechado. Por fim, se
        % $0 < a < 1$ e $a\in X$ vamos mostrar que existe $\delta > 0$
        % tal que $a + \delta \in X$, ou seja, que $X$ é aberto.
        % terminar a demonstração
        
        Vamos resolver um exercício ligeiramente diferente, considerando que $|f'(t)| \leq g'(t)$.
        Nesse caso, defina o funcional linear $\varphi:\R^n \to\R^n$ que manda
        %
        \begin{equation*}
            \varphi(\vec{v}) = \vec{v}\cdot\frac{f(1) - f(0)}{|f(1) - f(0)|}.
        \end{equation*}
        %
        Como $\varphi$ é funcional linear, segue que $(\varphi\circ f)'(t) = \varphi(f'(t))$ e,
        portanto,
        %
        \begin{equation*}
            |(\varphi\circ f)'(t)| = |\varphi(f'(t))| = |f'(t)| \leq g'(t),
        \end{equation*}
        %
        donde segue que
        %
        \begin{align*}
            |f(1) - f(0)| = \varphi(f(1) - f(0)) = \varphi(f(1)) - \varphi(f(0))
                                                 &= \int_0^1 (\varphi\circ f)'(t) \, dt \\
                                                 &\leq \int_0^1 |(\varphi\circ f)'(t)| \, dt \\
                                                 &\leq \int_0^1 g'(t) \, dt \\
                                                 &= g(1) - g(0),
        \end{align*}
        %
        como desejado.
    \end{proof}
    %
\end{document}